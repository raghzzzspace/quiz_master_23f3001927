{% extends 'user/user_base.html' %}

{% block title %}User Summary - Quizzy Quest{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-5" style="font-weight: 600; color: #3c3b6e;">User Summary</h2>

    <!-- Row for displaying the charts side by side with equal spacing and sizing -->
    <div class="row justify-content-center">
        <!-- Subject-wise number of quizzes Bar Chart -->
        <div class="col-md-6 mb-4">
            <canvas id="subjectBarChart" height="400"></canvas>
        </div>

        <!-- Month-wise number of quizzes attempted Pie Chart -->
        <div class="col-md-6 mb-4">
            <canvas id="monthPieChart" height="400"></canvas>
        </div>
    </div>
</div>

<!-- Chart.js Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Get the context for the bar chart
    const ctxBar = document.getElementById('subjectBarChart').getContext('2d');

    // Create a darker gradient for the bars based on navbar colors
    const gradient = ctxBar.createLinearGradient(0, 0, 0, 400); // gradient from top to bottom
    gradient.addColorStop(0, '#0056b3'); // Darker start color (deep blue)
    gradient.addColorStop(1, '#003d73'); // Darker end color (deep blue shade)

    // Sample data for Subject-wise Number of Quizzes (Bar Chart)
    const subjectData = {
        labels: ['Math', 'Science', 'History', 'Literature', 'Geography'], // Replace with actual subjects
        datasets: [{
            label: 'Number of Quizzes',
            data: [5, 3, 7, 4, 6], // Replace with actual quiz counts for each subject
            backgroundColor: gradient, // Apply the gradient to the bars
            borderColor: '#003366',  // Even darker blue for border
            borderWidth: 1
        }]
    };

    // Sample data for Month-wise Number of Quizzes Attempted (Pie Chart)
    const monthData = {
        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'], 
        datasets: [{
            label: 'Quizzes Attempted',
            data: [3, 5, 2, 4, 6, 7, 3, 2, 4, 5, 6, 8], // Replace with actual data for quizzes attempted each month
            backgroundColor: [
                '#ff6347', '#ff4500', '#ff8c00', '#ffd700', '#9acd32', '#32cd32', '#00ced1', '#20b2aa', '#4682b4', '#6a5acd', '#8a2be2', '#d2691e'
            ],
            hoverOffset: 4
        }]
    };

    // Configuration for the Subject-wise Bar Chart with Darker Gradient
    const subjectBarConfig = {
        type: 'bar',
        data: subjectData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            size: 14,
                            family: 'Arial, sans-serif',
                            weight: 'bold'
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            return `Number of Quizzes: ${tooltipItem.raw}`;
                        }
                    }
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    grid: {
                        display: false
                    }
                },
                y: {
                    beginAtZero: true
                }
            },
            barThickness: 40, // Increase thickness of bars
            categoryPercentage: 0.75, // Adjust spacing between bars
            maintainAspectRatio: false // Let the chart adjust its height automatically
        }
    };

    // Configuration for the Month-wise Pie Chart
    const monthPieConfig = {
        type: 'pie',
        data: monthData,
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            size: 14,
                            family: 'Arial, sans-serif',
                            weight: 'bold'
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            return `Quizzes Attempted: ${tooltipItem.raw}`;
                        }
                    }
                }
            }
        }
    };

    // Render the Bar Chart for Subject-wise Number of Quizzes
    const subjectBarChart = new Chart(document.getElementById('subjectBarChart'), subjectBarConfig);

    // Render the Pie Chart for Month-wise Number of Quizzes Attempted
    const monthPieChart = new Chart(document.getElementById('monthPieChart'), monthPieConfig);
</script>
{% endblock %}
